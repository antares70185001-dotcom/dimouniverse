<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë””ëª¨ ë°œëª… ì¹´ë“œ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Jua&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@700;800&display=swap" rel="stylesheet">
  <style>
    :root { 
      --main:#5cab6d;
      --accent:#a5e6b8;
      --bg:#f8fff9;
    }
    body { font-family:"Arial",sans-serif; background:var(--bg); text-align:center; margin:0; padding:20px; }
    .screen { display:none; } 
    .active { display:block; }
    video { width:780px; max-width:100%; border-radius:20px; margin:20px auto; display:block; box-shadow:0 12px 40px rgba(0,0,0,0.3); }
    
    .title { 
      font-family:'Jua', sans-serif; 
      font-size:58px; 
      font-weight:bold; 
      margin:15px 0; 
      color:var(--main); 
      text-shadow:2px 2px 6px rgba(0,0,0,0.2);
    }
    .start-btn{ margin:20px auto; background:var(--accent); border:none; padding:14px 32px; border-radius:30px; cursor:pointer; font-size:20px; font-weight:bold; color:#2d4d38; transition:all .3s ease; display:inline-block; box-shadow:0 6px 14px rgba(0,0,0,0.15);}
    .start-btn:hover{ background:#8ed8a3; transform:scale(1.05); }
  </style>
</head>
<body>
  <!-- 1) ì¸íŠ¸ë¡œ -->
  <div id="introScreen" class="screen active">
    <h1 class="title">ë””ëª¨ë‘ í•¨ê»˜í•˜ëŠ” ë°œëª… ë†€ì´í„° âœ¨</h1>
    <button onclick="startIntro()" class="start-btn">â–¶ ë””ëª¨ ë§Œë‚˜ëŸ¬ ê°€ê¸°</button>
    <video autoplay muted loop playsinline webkit-playsinline>
      <source src="dimo.mp4" type="video/mp4">
    </video>
    <!-- ì‹¤ì œ ì—…ë¡œë“œëœ ì¸íŠ¸ë¡œ ì˜¤ë””ì˜¤ 4ê°œ -->
    <audio id="introAudio1" src="ë””ëª¨ ì¸íŠ¸ë¡œ ì¸ì‚¬.mp3" preload="auto"></audio>
    <audio id="introAudio2" src="ë””ëª¨ì¸ì‚¬01.mp3" preload="auto"></audio>
    <audio id="introAudio3" src="ë””ëª¨ì¸ì‚¬02.mp3" preload="auto"></audio>
    <audio id="introAudio4" src="ë””ëª¨ì¸ì‚¬03.mp3" preload="auto"></audio>
  </div>

  <!-- 2) ì„¤ë¬¸ -->
  <div id="formScreen" class="screen">
    <h2 class="section-title">ğŸ“£ ë””ëª¨ì—ê²Œ ì•Œë ¤ì¤˜</h2>
    <form id="ideaForm">
      <div class="form-group">
        <label>ë³„ëª… *</label>
        <input type="text" id="nickname" required>
      </div>
      <div class="form-group">
        <label>ë‚´ ë°œëª…í’ˆ ì´ë¦„ *</label>
        <input type="text" id="ideaName" required>
      </div>
      <div class="form-group">
        <label>ë°œëª… ì„¤ëª… *</label>
        <textarea id="ideaDetail" required></textarea>
      </div>
      <button type="submit" class="start-btn">ë””ëª¨ì—ê²Œ ë³´ë‚´ê¸°</button>
    </form>
  </div>

  <!-- 3) ê²°ê³¼ -->
  <div id="resultScreen" class="screen">
    <video autoplay muted loop playsinline webkit-playsinline>
      <source src="dimo.mp4" type="video/mp4">
    </video>
    <div id="celebrationArea" class="celebration-card">
      <h2 class="banner">ğŸ‰ ì¶•í•˜í•´ìš”! ë‚˜ë§Œì˜ ì•„ì´ë””ì–´ ì¹´ë“œ ğŸ‰</h2>
      <div class="card-body">
        <img id="dimoImage" src="" alt="ë””ëª¨ ìºë¦­í„°" class="dimo-left">
        <div class="ratings-wrap">
          <div class="rating"><h3>ë°˜ì§ì´ëŠ” ìƒìƒë ¥</h3><div id="creativity" class="stars"></div></div>
          <div class="rating"><h3>ì •ë§ ë ê¹Œ? ì ìˆ˜</h3><div id="feasibility" class="stars"></div></div>
          <div class="rating"><h3>ë””ëª¨ì˜ ê¸°ìˆ ë ¥ ë ˆë²¨</h3><div id="technical" class="stars"></div></div>
        </div>
      </div>
      <div id="ideaInfo" class="idea-info">
        ğŸ‘¤ <strong>ë°œëª…ì:</strong> <span id="inventorName"></span> | ğŸ’¡ <strong>ë‚´ ë°œëª…í’ˆ:</strong> <span id="ideaDisplay"></span>
      </div>
      <div class="card-footer-logo">DIMO UNIVERSE</div>
      <div id="stampArea"></div>
    </div>
    <button id="shareBtn" class="start-btn">ğŸ¨ ì¹´ë“œ ì €ì¥í•˜ê¸°</button>
  </div>

  <!-- ì¹­ì°¬ ì˜¤ë””ì˜¤ (ì‹¤ì œ ì—…ë¡œë“œëœ 3ê°œë§Œ ì ìš©) -->
  <audio id="compliment1" src="ë””ëª¨ì¹­ì°¬01.mp3" preload="auto"></audio>
  <audio id="compliment2" src="ë””ëª¨ì¹­ì°¬02.mp3" preload="auto"></audio>
  <audio id="compliment3" src="ë””ëª¨ ì¹­ì°¬ ë©”ì‹œì§€.mp3" preload="auto"></audio>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script>
    const dimoImages = ["dimo01.png","dimo02.png","dimo03.png","dimo04.png"];
    const introAudios = [
      document.getElementById("introAudio1"),
      document.getElementById("introAudio2"),
      document.getElementById("introAudio3"),
      document.getElementById("introAudio4")
    ];
    const complimentAudios = [
      document.getElementById("compliment1"),
      document.getElementById("compliment2"),
      document.getElementById("compliment3")
    ];

    // ì¸íŠ¸ë¡œ ëœë¤ ì¬ìƒ
    function startIntro(){
      document.getElementById("introScreen").classList.remove("active"); 
      document.getElementById("formScreen").classList.add("active"); 
      const audio = introAudios[Math.floor(Math.random()*introAudios.length)];
      audio.play().catch(()=>{});
    }

    function showResult(){
      document.getElementById("formScreen").classList.remove("active");
      document.getElementById("resultScreen").classList.add("active");

      const randomImg = dimoImages[Math.floor(Math.random()*dimoImages.length)];
      document.getElementById("dimoImage").src = randomImg;
      document.getElementById("inventorName").innerText = document.getElementById("nickname").value;
      document.getElementById("ideaDisplay").innerText = document.getElementById("ideaName").value;

      // ë³„ì  ëœë¤
      ["creativity","feasibility","technical"].forEach(id=>renderRandomStars(id));

      // confetti
      fireConfetti(2000);

      // ì¹­ì°¬ ì˜¤ë””ì˜¤
      const compliment = complimentAudios[Math.floor(Math.random()*complimentAudios.length)];
      compliment.play().catch(()=>{});

      // ìŠ¤íƒ¬í”„
      setTimeout(()=>{
        const stampArea = document.getElementById("stampArea");
        const card = document.getElementById("celebrationArea");
        const detail = document.getElementById("ideaDetail").value || "";
        const pureLen = detail.replace(/\s/g, "").length;
        if (pureLen >= 30) {
          stampArea.innerHTML = `<img src="ë””ëª¨ìŠ¤íƒ¬í”„01.png" alt="ìŠ¤íƒ¬í”„" style="position:absolute;right:20px;top:20px;width:120px;">`;
        } else {
          stampArea.innerHTML = "";
        }
      },2000);
    }

    function renderRandomStars(id){
      const el=document.getElementById(id);
      let score = (Math.floor((Math.random() * ((5-3.5)*2+1)) + 7) / 2);
      let html="";
      for(let i=1;i<=5;i++){
        if(score >= i){ html += "<span class='star full'>â˜…</span>"; }
        else if(score >= i-0.5){ html += "<span class='star half'>â˜…</span>"; }
        else { html += "<span class='star'>â˜…</span>"; }
      }
      el.innerHTML = html;
    }

    function fireConfetti(duration=2000){ 
      const end=Date.now()+duration; 
      (function frame(){ 
        confetti({particleCount:5,startVelocity:30,spread:360,origin:{x:Math.random(),y:Math.random()-0.2}}); 
        if(Date.now()<end) requestAnimationFrame(frame); 
      })(); 
    }

    // ì¹´ë“œ ì €ì¥
    document.getElementById("shareBtn").addEventListener("click", function(){
      const card = document.getElementById("celebrationArea");
      html2canvas(card, { scale: window.devicePixelRatio || 1 }).then(canvas => {
        const link=document.createElement("a");
        link.href=canvas.toDataURL("image/png");
        link.download="dimo_card.png";
        link.click();
      });
    });

    document.getElementById("ideaForm").addEventListener("submit", function(e){ 
      e.preventDefault(); 
      showResult(); 
    });
  </script>
</body>
</html>
